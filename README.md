# ‚ú® So you want to sponsor a contest

This `README.md` contains a set of checklists for our contest collaboration.

Your contest will use two repos: 
- **a _contest_ repo** (this one), which is used for scoping your contest and for providing information to contestants (wardens)
- **a _findings_ repo**, where issues are submitted. (We'll set that one up later.) 

Ultimately, when we launch the contest, this contest repo will be made public and will contain the smart contracts to be reviewed and all the information needed for contest participants. The findings repo will be made public after the contest is over and your team has mitigated the identified issues.

Some of the checklists in this doc are for **C4 (üê∫)** and some of them are for **you as the contest sponsor (‚≠êÔ∏è)**.

---

# Contest scoping

## ‚≠êÔ∏è Sponsor: Provide contest scoping details

Under "Contest scope information" below, include the following:

- [_] Name of each contract and:
  - [_] lines of code in each
  - [_] external contracts called in each
  - [_] libraries used in each
- [_] Describe any novel or unique curve logic or mathematical models implemented in the contracts
- [_] Does the token conform to the ERC-20 standard? In what specific ways does it differ?
- [_] Describe anything else that adds any special logic that makes your approach unique
- [_] Identify any areas of specific concern in reviewing the code
- [ ] Add all of the code to this repo that you want reviewed
- [ ] Create a PR to this repo with the above changes.
- [ ] Delete this checklist and wait for C4 to provide a recommended contest minimum.

---

# Contest scope information

[ ‚≠êÔ∏è SPONSORS ADD INFO HERE ]
Yield v2 is a collateralized debt engine paired with a custom automated market maker.

The product offered by Yield v2 is fixed rate borrowing and lending.
 - Borrowing: Users deposit collateral to borrow fyTokens, which are immediately sold in YieldSpace for underlying. The combined effect is collateralized borrowing of underlying at a fixed rate, if they maintain ther debt until maturity.
 - Lending: Users sell underlying in YieldSpace to buy fyToken. They are effectively lending underlying at a fixed rate if they hold the fyToken to maturity and redeem them.
 - Liquidity Providing: The YieldSpace AMM requires liquidity, that Liquidity Providers add in exchange for fees generated by the use of YieldSpace by borrowers and lenders.

Cast*.sol (9 sloc each)
The Cast*.sol libraries convert safely between different types.

WDiv.sol (9 sloc)
Fixed point division.

WDivUp.sol (11 sloc)
Fixed point division, rounding up.

WMul.sol (9 sloc)
Fixed point multiplication.

ERC20.sol (84 sloc)
Custom implementation of the ERC20 specifications.
Differs from ERC20 standard on when allowances are required and decreased, same as DS-Token.sol.

ERC20Permit.sol (67 sloc)
Extension of ERC20 to accept ERC2612 off-chain approvals.

AccessControl.sol (226 sloc)
Access control contract adapted from OpenZeppelin's AccessControl.sol. A role exists for each function in a contract, and if the `auth` modifier is present in a function, access must have been granted by the root account. The privileged account can grant and revoke roles, as well as root privileges.
Root can lock functions, disabling any further changes in their access control, except for existing users renouncing to granted roles.

Ownable.sol (21 sloc)
Contract to create a single privileged role that can be held by a single address

TransferHelper.sol (29 sloc)
Adapted from Uniswap & BoringSolidity. Safe transferring of ERC20 tokens and Ether, regardless of reverts or return values.

MinimalTransferHelper.sol (29 sloc)
Adapted from Uniswap & BoringSolidity. Safe transferring of ERC20 tokens, regardless of reverts or return values.

ChainlinkMultiOracle.sol (52 sloc)
Calls Chainlink aggregators to return the value of an asset amount.
One contract deployed.

CompoundMultiOracle.sol (52 sloc)
Calls Compound cTokens to return the borrowing and lending rate.
One contract deployed.

Join.sol (120 sloc)
Asset holding. Only privileged accounts or contracts can move assets out of the Join, or ask the Join to take assets. Can serve ERC3156 flash loans.
One contract per asset deployed.

FYToken.sol (204 sloc)
ERC20 zero coupon bond, redeemable at maturity for underlying.
Calls Join.sol to obtain funds to serve redemptions, and an Oracle to determine the savings rate, which will be applied to redemptions as well. Can be flash minted with no fees following the ERC3156 standard.
Numerous contracts deployed.

Cauldron.sol (412 sloc)
Accounting system for Yield v2. The only external dependencies are towards rate oracles and spot oracles. All transactional functions require privileged access. The main function besides accounting is to reveal whether a vault is collateralized using the `ink * price * ratio >= art * accrual * rate` formula.
One contract deployed.

Ladle.sol (468 sloc)
Routing and asset management for Yield v2. It has considerable privileges:
 - Moves assets in and out of the Joins
 - Mints and burns fyToken
 - Updates accounting in the Cauldron
 - Collects approvals from users for transfers to pools and fyToken
 - Calls YieldSpace functions
It also implements a batching system to group several calls together.

Witch.sol (67 sloc)
Liquidations engine, same implementation from Yield v1, refactored. Calls the Ladle to move assets, and the Cauldron to obtain and release control of undercollateralized vaults.

Math64x64.sol (693 lines)
ABDK's Math64x64, upgraded to 0.8. Very complex math library, for which only a series of changes were made to use the 0.8 compiler.

YieldMath.sol (507 lines)
YieldSpace AMM curve implementation. Same curve implementation from Yield v1. It was refactored to make the math clearer. Uses Math64x64.sol.

Pool.sol (613 sloc)
YieldSpace AMM implementation. Refactored from Yield v1, to add a TWAR oracle, single-asset mint and burn, and remove all `transferFrom` in favour of keeping track of balances.

PoolFactory.sol (77 sloc)
Deployment of YieldSpace Pools using CREATE2.

PoolRouter.sol (142 sloc)
Batching of calls to Pools, along with wrapping/unwrapping of Ether, management of off-chain approvals, and transfers of tokens from users to pools to kickstart transactions.


---

# Contest prep

## üê∫ C4: Contest prep
- [ ] Rename contest H1 below
- [ ] Add link to report form in contest details below
- [ ] Update pot sizes
- [ ] Fill in start and end times in contest bullets below.
- [ ] Move any relevant information in "contest scope information" above to the bottom of this readme.
- [ ] Add matching info to the [code423n4.com public contest data here](https://github.com/code-423n4/code423n4.com/tree/main/data/contests))
- [ ] Delete this checklist.

## ‚≠êÔ∏è Sponsor: Contest prep
- [ ] Make sure your code is thoroughly commented using the [NatSpec format](https://docs.soliditylang.org/en/v0.5.10/natspec-format.html#natspec-format).
- [ ] Modify the bottom of this `README.md` file to describe how your code is supposed to work with links to any relevent documentation and any other criteria/details that the C4 Wardens should keep in mind when reviewing
- [ ] Please have final versions of contracts and documentation added/updated in this repo **no less than 8 hours prior to contest start time.**
- [ ] Ensure that you have access to the _findings_ repo where issues will be submitted.
- [ ] Delete this checklist and all text above the line below when you're ready.

---

# Sponsorname contest details
- TBD main award pot
- TBD gas optimization award pot
- Join [C4 Discord](https://discord.gg/EY5dvm3evD) to register
- Submit findings [using the C4 form](https://c4-TBD.netlify.app/)
- [Read our guidelines for more details](https://code423n4.com/compete)
- Starts TBD XXX XXX XX 00:00 UTC
- Ends TBD XXX XXX XX 23:59 UTC

This repo will be made public before the start of the contest.

[ ‚≠êÔ∏è SPONSORS ADD INFO HERE ]
